{% extends "base.html" %}

{% block title %}Gesti√≥n de Categor√≠as{% endblock %}

{% block content %}
<div class="min-h-screen dark-bg p-6">
<h1 class="text-2xl font-bold mb-6 dark-text">Gesti√≥n de Categor√≠as</h1>

<div class="dark-card overflow-hidden mb-6">
    <table class="table-auto w-full">
        <thead class="bg-gray-800 dark:bg-gray-900">
            <tr>
                <th class="px-4 py-2 text-white">ID</th>
                <th class="px-4 py-2 text-white">Categor√≠a</th>
                <th class="px-4 py-2 text-white">Acciones</th>
            </tr>
        </thead>
        <tbody>
        {% for category in categories %}
        <tr class="odd:bg-gray-50 odd:dark:bg-gray-800 even:bg-white even:dark:bg-gray-700 hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors">
            <td class="dark-border px-4 py-2 text-center dark-text">{{ category.idcat }}</td>
            <td class="dark-border px-4 py-2 dark-text">{{ category.tipcat }}</td>
            <td class="dark-border px-4 py-2 text-center">
                <form action="{{ url_for('admin.delete_category', id=category.idcat) }}" method="post" class="inline delete-form">
                    <button type="submit" 
                            class="bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded text-sm transition-colors"
                            onclick="return confirm('¬øEst√°s seguro de eliminar la categor√≠a &quot;{{ category.tipcat }}&quot;? Esta acci√≥n no se puede deshacer.')">
                        üóëÔ∏è Eliminar
                    </button>
                </form>
            </td>
        </tr>
        {% endfor %}
        </tbody>
    </table>
</div>

<div class="dark-card p-6">
    <h2 class="text-xl font-bold mb-4 dark-text">Agregar Nueva Categor√≠a</h2>
    <form action="/admin/categories" method="post" class="space-y-4">
        <input type="text" name="tipcat" placeholder="Nombre de la Categor√≠a" class="input" required>
        <button type="submit" class="bg-blue-500 dark:bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-600 dark:hover:bg-blue-700 transition-colors">Agregar</button>
    </form>
</div>
</div>

<script>
// Mejorar la experiencia de categor√≠as
document.addEventListener('DOMContentLoaded', function() {
    // Validaci√≥n del formulario de nueva categor√≠a
    const form = document.querySelector('form[action="/admin/categories"]');
    const input = form.querySelector('input[name="tipcat"]');
    
    form.addEventListener('submit', function(e) {
        const value = input.value.trim();
        
        if (value.length < 2) {
            e.preventDefault();
            input.classList.add('border-red-500');
            if (window.showToast) {
                window.showToast('El nombre de la categor√≠a debe tener al menos 2 caracteres', 'error');
            }
            return;
        }
        
        input.classList.remove('border-red-500');
    });

    // Limpiar errores al escribir
    input.addEventListener('input', function() {
        this.classList.remove('border-red-500');
    });

    // Animaci√≥n de las filas
    const rows = document.querySelectorAll('tbody tr');
    rows.forEach((row, index) => {
        row.style.opacity = '0';
        row.style.transform = 'translateY(20px)';
        
        setTimeout(() => {
            row.style.transition = 'all 0.5s ease-out';
            row.style.opacity = '1';
            row.style.transform = 'translateY(0)';
        }, index * 100);
    });

    // Confirmar antes de enviar
    form.addEventListener('submit', function(e) {
        if (input.value.trim()) {
            const confirmMsg = `¬øAgregar la categor√≠a "${input.value.trim()}"?`;
            if (!confirm(confirmMsg)) {
                e.preventDefault();
            }
        }
    });

    console.log('üìÇ Categories management enhancements loaded');
});
</script>
{% endblock %}